# All backend services under backend/services/
# Create .env from .env.example in each service dir for API keys (fact_checking has .env.example).
# If .env is missing, create an empty file or remove the env_file key for that service.
services:
  media_checking:
    build:
      context: media_checking
      dockerfile: Dockerfile
    ports:
      - "8000:8000"
    container_name: hte-media-checking
    env_file:
      - media_checking/.env
    dns:
      - 8.8.8.8
      - 8.8.4.4

  fact_checking:
    build:
      context: fact_checking
      dockerfile: Dockerfile
    ports:
      - "8001:8001"
    container_name: hte-fact-checking
    env_file:
      - fact_checking/.env
    dns:
      - 8.8.8.8
      - 8.8.4.4

  ai_text_detector:
    build:
      context: ai_text_detector
      dockerfile: Dockerfile
    ports:
      - "8002:8002"
    container_name: hte-ai-text-detector
    env_file:
      - ai_text_detector/.env
    dns:
      - 8.8.8.8
      - 8.8.4.4

  info_graph:
    build:
      context: info_graph
      dockerfile: Dockerfile
    ports:
      - "8004:8004"
    container_name: hte-info-graph
    env_file:
      - info_graph/.env
    dns:
      - 8.8.8.8
      - 8.8.4.4

  content_safety:
    build:
      context: content_safety
      dockerfile: Dockerfile
    ports:
      - "8005:8005"
    container_name: hte-content-safety
    env_file:
      - content_safety/.env
    dns:
      - 8.8.8.8
      - 8.8.4.4

  agent_gateway:
    build:
      context: agent_gateway
      dockerfile: Dockerfile
    ports:
      - "8003:8003"
    container_name: hte-agent-gateway
    env_file:
      - agent_gateway/.env
    # So the container can reach Django portal on the host. Override in .env if your portal runs on another port.
    environment:
      - AGENT_GATEWAY_PORTAL_BASE_URL=${AGENT_GATEWAY_PORTAL_BASE_URL:-http://host.docker.internal:8000}
    # Linux: host.docker.internal is not defined by default; this makes it resolve to the host
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - 8.8.8.8
      - 8.8.4.4

  media_explanation:
    build:
      context: media_explanation
      dockerfile: Dockerfile
    ports:
      - "8006:8006"
    container_name: hte-media-explanation
    env_file:
      - media_explanation/.env
    dns:
      - 8.8.8.8
      - 8.8.4.4
